---
import Layout from '../layouts/Layout.astro';
---
<Layout title="Caesar-Chiffre" emoji="ğŸ›ï¸">
  <!-- Hero -->
  <section class="section text-center max-w-3xl mx-auto px-6 pb-12">
    <div class="text-6xl mb-6 animate-fade-in">ğŸ›ï¸</div>
    <h1 class="text-4xl md:text-5xl font-extrabold tracking-tight mb-4">
      <span class="gradient-text-warm">Caesar-Chiffre</span>
    </h1>
    <p class="text-lg text-gray-500 max-w-xl mx-auto">
      Julius Caesar verschlÃ¼sselte seine Botschaften, indem er jeden Buchstaben im Alphabet verschob. Einfach â€” aber genial.
    </p>
  </section>

  <!-- How it works -->
  <section class="max-w-3xl mx-auto px-6 mb-16">
    <div class="card">
      <h2 class="text-2xl font-bold mb-4">So funktioniert's</h2>
      <p class="text-gray-500 mb-6">Verschiebe das Alphabet um eine bestimmte Anzahl Stellen:</p>
      <div class="bg-pastel-gray rounded-2xl p-5 font-mono text-sm md:text-base overflow-x-auto mb-6">
        <p><span class="text-gray-400 mr-2">Normal:</span>  A B C D E F G H I J K L M N O P Q R S T U V W X Y Z</p>
        <p class="text-apple-orange font-semibold"><span class="text-gray-400 mr-2 font-normal">+3:</span>     D E F G H I J K L M N O P Q R S T U V W X Y Z A B C</p>
      </div>
      <div class="bg-pastel-orange rounded-2xl p-6 text-center">
        <p class="text-lg">
          <span class="text-gray-500">HALLO</span>
          <span class="mx-3 text-gray-300">â†’</span>
          <span class="text-apple-orange font-bold text-2xl">KDOOR</span>
        </p>
      </div>
    </div>
  </section>

  <!-- Interactive Tool -->
  <section class="bg-pastel-gray py-16">
    <div class="max-w-3xl mx-auto px-6">
      <h2 class="text-2xl md:text-3xl font-bold text-center mb-10">Probier's aus</h2>

      <div class="bg-white rounded-3xl p-8 shadow-soft">
        <div class="mb-6">
          <label class="block text-sm font-semibold text-gray-700 mb-2">Deine Nachricht</label>
          <input type="text" id="caesar-input" placeholder="Schreibe hier deine geheime Nachricht..."
                 class="tool-input" maxlength="100" />
        </div>

        <div class="mb-8">
          <label class="block text-sm font-semibold text-gray-700 mb-2">
            Verschiebung: <span id="shift-display" class="text-apple-orange">3</span>
          </label>
          <input type="range" id="caesar-shift" min="1" max="25" value="3" />
        </div>

        <div class="flex gap-3 mb-8 flex-wrap">
          <button id="btn-encrypt" class="btn btn-orange">
            VerschlÃ¼sseln
          </button>
          <button id="btn-decrypt" class="btn btn-indigo">
            EntschlÃ¼sseln
          </button>
        </div>

        <div>
          <label class="block text-sm font-semibold text-gray-700 mb-2">Ergebnis</label>
          <div id="caesar-output" class="tool-output text-xl font-semibold text-apple-orange text-center">
            â€¦
          </div>
        </div>
      </div>

      <!-- Alphabet display -->
      <div class="mt-8 bg-white rounded-3xl p-6 shadow-soft">
        <h3 class="text-sm font-semibold text-gray-400 uppercase tracking-wider mb-4 text-center">Alphabet-Zuordnung</h3>
        <div id="alphabet-display" class="grid grid-cols-13 gap-1 max-w-2xl mx-auto"></div>
      </div>
    </div>
  </section>

  <!-- Challenge -->
  <section class="section max-w-3xl mx-auto px-6">
    <div class="card text-center">
      <h2 class="text-2xl font-bold mb-4">ğŸ† Herausforderung</h2>
      <p class="text-gray-500 mb-6">EntschlÃ¼ssle diese Nachricht â€” Verschiebung ist <strong class="text-gray-900">7</strong>:</p>
      <p class="text-2xl md:text-3xl font-mono font-bold text-apple-indigo bg-pastel-indigo rounded-2xl p-6">
        NLKPTLU JLOLPT
      </p>
      <details class="mt-6">
        <summary class="cursor-pointer text-apple-blue font-semibold hover:underline text-sm">LÃ¶sung anzeigen</summary>
        <p class="mt-3 text-lg font-semibold">GEHEIME CODES ğŸ‰</p>
      </details>
    </div>
  </section>

  <script>
    const ALPHA = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
    const input = document.getElementById('caesar-input') as HTMLInputElement;
    const shift = document.getElementById('caesar-shift') as HTMLInputElement;
    const shiftDisplay = document.getElementById('shift-display')!;
    const output = document.getElementById('caesar-output')!;
    const alphaDisplay = document.getElementById('alphabet-display')!;

    function caesarShift(text: string, n: number, decrypt = false): string {
      if (decrypt) n = 26 - n;
      return text.toUpperCase().split('').map(c => {
        const i = ALPHA.indexOf(c);
        return i >= 0 ? ALPHA[(i + n) % 26] : c;
      }).join('');
    }

    function updateAlpha() {
      const n = parseInt(shift.value);
      alphaDisplay.innerHTML = ALPHA.split('').map((c, i) => {
        const shifted = ALPHA[(i + n) % 26];
        return `<div class="text-center py-1">
          <div class="text-xs font-semibold text-gray-400">${c}</div>
          <div class="text-xs text-gray-300">â†“</div>
          <div class="text-xs font-bold text-apple-orange">${shifted}</div>
        </div>`;
      }).join('');
    }

    shift.addEventListener('input', () => {
      shiftDisplay.textContent = shift.value;
      updateAlpha();
    });

    document.getElementById('btn-encrypt')!.addEventListener('click', () => {
      output.textContent = caesarShift(input.value, parseInt(shift.value)) || 'â€¦';
    });
    document.getElementById('btn-decrypt')!.addEventListener('click', () => {
      output.textContent = caesarShift(input.value, parseInt(shift.value), true) || 'â€¦';
    });

    updateAlpha();
  </script>
</Layout>
