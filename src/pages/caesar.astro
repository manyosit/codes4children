---
import Layout from '../layouts/Layout.astro';
---
<Layout title="Caesar-Chiffre" emoji="ğŸ›ï¸">
  <div class="text-center mb-8">
    <div class="text-7xl mb-4">ğŸ›ï¸</div>
    <h1 class="text-5xl font-fun font-bold rainbow-text">Caesar-Chiffre</h1>
    <p class="text-xl text-gray-600 mt-4 max-w-2xl mx-auto">
      Julius Caesar hat seine geheimen Botschaften verschlÃ¼sselt, indem er jeden Buchstaben
      im Alphabet um eine bestimmte Anzahl verschoben hat. Schlau, oder? ğŸ§ 
    </p>
  </div>

  <!-- How it works -->
  <div class="bg-white rounded-3xl p-8 shadow-xl mb-8">
    <h2 class="text-3xl font-fun font-bold text-candy-orange mb-4">ğŸ“– So funktioniert's</h2>
    <p class="text-lg mb-4">
      Stell dir vor, du verschiebst das ganze Alphabet um <strong>3 Stellen</strong>:
    </p>
    <div class="overflow-x-auto">
      <div class="bg-gradient-to-r from-candy-orange/10 to-candy-yellow/10 rounded-2xl p-4 font-mono text-center mb-4">
        <p class="text-lg"><strong>Normal:</strong>  A B C D E F G H I J K L M N O P Q R S T U V W X Y Z</p>
        <p class="text-lg text-candy-orange font-bold"><strong>Geheim:</strong> D E F G H I J K L M N O P Q R S T U V W X Y Z A B C</p>
      </div>
    </div>
    <div class="bg-candy-yellow/20 rounded-2xl p-6 text-center">
      <p class="text-xl">Aus <strong class="text-3xl">HALLO</strong> wird <strong class="text-3xl text-candy-orange">KDOOR</strong>! ğŸ¤¯</p>
    </div>
  </div>

  <!-- Interactive Tool -->
  <div class="bg-gradient-to-br from-candy-orange/20 to-candy-yellow/20 rounded-3xl p-8 shadow-xl mb-8">
    <h2 class="text-3xl font-fun font-bold text-candy-orange mb-6">ğŸ”§ Probier's selbst aus!</h2>

    <div class="mb-6">
      <label class="block text-lg font-bold mb-2">ğŸ“ Deine Nachricht:</label>
      <input type="text" id="caesar-input" placeholder="Schreibe hier deine geheime Nachricht..."
             class="tool-input" maxlength="100" />
    </div>

    <div class="mb-6">
      <label class="block text-lg font-bold mb-2">ğŸ”„ Verschiebung: <span id="shift-display" class="text-candy-orange text-2xl">3</span></label>
      <input type="range" id="caesar-shift" min="1" max="25" value="3"
             class="w-full h-3 rounded-full appearance-none bg-candy-orange/30 cursor-pointer" />
      <div class="flex justify-between text-sm text-gray-400 mt-1">
        <span>1</span><span>13</span><span>25</span>
      </div>
    </div>

    <div class="flex gap-4 mb-6 flex-wrap">
      <button id="btn-encrypt" class="btn-fun bg-gradient-to-r from-candy-orange to-candy-yellow">
        ğŸ”’ VerschlÃ¼sseln
      </button>
      <button id="btn-decrypt" class="btn-fun bg-gradient-to-r from-candy-purple to-candy-pink">
        ğŸ”“ EntschlÃ¼sseln
      </button>
    </div>

    <div>
      <label class="block text-lg font-bold mb-2">âœ¨ Ergebnis:</label>
      <div id="caesar-output" class="tool-output text-2xl font-bold text-candy-orange text-center">
        Hier erscheint dein Geheimtext...
      </div>
    </div>
  </div>

  <!-- Alphabet wheel SVG -->
  <div class="bg-white rounded-3xl p-8 shadow-xl mb-8 text-center">
    <h2 class="text-3xl font-fun font-bold text-candy-orange mb-4">ğŸ¡ Das Verschiebe-Alphabet</h2>
    <div id="alphabet-display" class="grid grid-cols-13 gap-1 max-w-xl mx-auto">
    </div>
  </div>

  <!-- Challenge -->
  <div class="bg-gradient-to-r from-candy-red/20 to-candy-orange/20 rounded-3xl p-8 shadow-xl">
    <h2 class="text-3xl font-fun font-bold text-candy-red mb-4">ğŸ† Herausforderung!</h2>
    <p class="text-lg mb-4">Kannst du diese Nachricht entschlÃ¼sseln? Die Verschiebung ist <strong>7</strong>:</p>
    <p class="text-3xl font-mono text-center bg-white rounded-2xl p-6 font-bold text-candy-purple">
      NLKPTLU JLOLPT
    </p>
    <details class="mt-4">
      <summary class="cursor-pointer text-candy-orange font-bold text-lg hover:underline">ğŸ’¡ LÃ¶sung anzeigen</summary>
      <p class="mt-2 text-xl text-center font-bold">GEHEIME CODES â†’ Verschiebung 7 zurÃ¼ck!</p>
    </details>
  </div>

  <script>
    const ALPHA = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
    const input = document.getElementById('caesar-input') as HTMLInputElement;
    const shift = document.getElementById('caesar-shift') as HTMLInputElement;
    const shiftDisplay = document.getElementById('shift-display')!;
    const output = document.getElementById('caesar-output')!;
    const alphaDisplay = document.getElementById('alphabet-display')!;

    function caesarShift(text: string, n: number, decrypt = false): string {
      if (decrypt) n = 26 - n;
      return text.toUpperCase().split('').map(c => {
        const i = ALPHA.indexOf(c);
        return i >= 0 ? ALPHA[(i + n) % 26] : c;
      }).join('');
    }

    function updateAlpha() {
      const n = parseInt(shift.value);
      alphaDisplay.innerHTML = ALPHA.split('').map((c, i) => {
        const shifted = ALPHA[(i + n) % 26];
        return `<div class="text-center">
          <div class="text-lg font-bold">${c}</div>
          <div class="text-xs text-gray-400">â†“</div>
          <div class="text-lg font-bold text-candy-orange">${shifted}</div>
        </div>`;
      }).join('');
    }

    shift.addEventListener('input', () => {
      shiftDisplay.textContent = shift.value;
      updateAlpha();
    });

    document.getElementById('btn-encrypt')!.addEventListener('click', () => {
      output.textContent = caesarShift(input.value, parseInt(shift.value)) || 'Schreibe erst etwas oben rein! â˜ï¸';
    });

    document.getElementById('btn-decrypt')!.addEventListener('click', () => {
      output.textContent = caesarShift(input.value, parseInt(shift.value), true) || 'Schreibe erst etwas oben rein! â˜ï¸';
    });

    updateAlpha();
  </script>
</Layout>
